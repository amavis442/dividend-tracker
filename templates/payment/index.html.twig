{% extends 'base.html.twig' %}

{% block title %}Payments
{% endblock %}

{% block body %}
	<h1>Payments:
		{{ startDate}}
		/
		{{ endDate}}</h1>

	{{ form_start(searchForm) }}
	<div class="form-row">
		<div class="col">
			{{form_widget(searchForm.year)}}
		</div>
		<div class="col">
			{{form_widget(searchForm.month)}}
		</div>
		<div class="col">
			{{form_widget(searchForm.quator)}}
		</div>
		<div class="col">
			{{form_widget(searchForm.send)}}
		</div>
	</div>
	{{ form_end(searchForm) }}

	<br/>
	{% include '_search_form.html.twig' %}
	<table class="table">
		<thead>
			<tr>
				<th>Pay date</th>
				<th>Ticker</th>
				<th>Industry</th>
				<th>Amount</th>
				<th>Dividend(&euro;)</th>
				<th>Taxes (15%)</th>
				<th>Broker</th>
				<th>actions</th>
			</tr>
		</thead>
		<tbody>
			{% for payment in payments %}
				<tr>
					<td>{{ payment.payDate ? payment.payDate|date('d-m-Y') : '' }}</td>
					<td>{{ payment.position.ticker.fullname }}
						({{ payment.position.ticker.ticker }})</td>
					<td>{{ payment.position.ticker.branch.label }}</td>
					<td>{{ (payment.amount/10000000)|format_number({fraction_digit: 7}) }}</td>
					<td>{{ (payment.currency ? payment.currency.sign : '$')|raw }}{{ (payment.dividend/1000)|format_number({fraction_digit: 2}) }}</td>
					<td>&euro;{{ (payment.taxes/1000)|format_number({fraction_digit: 2}) }}</td>
					<td>{{ payment.broker }}</td>
					<td>
						<a href="{{ path('payment_show', {'id': payment.id}) }}" class="btn btn-primary">
							<i class="fas fa-book-open"></i>
						</a>
						<a href="{{ path('payment_edit', {'id': payment.id}) }}" class="btn btn-primary">
							<i class="far fa-edit"></i>
						</a>
					</td>
				</tr>
			{% else %}
				<tr>
					<td colspan="8">no records found</td>
				</tr>
			{% endfor %}
			<tr>
				<td colspan="3"></td>
				<td>
					<span style="font-weight:bold">Total dividend
						{% if tab > 'All' %}this
							{{ tab }}
						{% endif %}
					</span>
				</td>
				<td>&euro;
					{{ dividends }}</td>
				<td>&euro;{{ taxes|format_number({fraction_digit: 2}) }}</td>
				<td></td>
			</tr>
		</tbody>
	</table>
	{% include 'paginator.html.twig' %}
{% endblock %}
