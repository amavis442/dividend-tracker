{% extends 'base.html.twig' %}

{% block title %}Dividend Yield 
{% endblock %}

{% block body %}
	<div class="card" style="margin-bottom:10px;margin-top:10px">
  		<div class="card-body">
		  <strong>Yield on cost dividend:</strong><br/>
		  Total dividend in a year / total allocated = 
		  &euro;{{ totalNetYearlyDividend|format_number({fraction_digit: 2}) }} / 
		  &euro;{{ allocated|format_number({fraction_digit: 2}) }} =
		  <strong>{{ dividendYieldOnCost|format_number({fraction_digit: 2}) }}%</strong>
		</div>
	</div>

    <div style='width:1000px;height:600px' class="col col-xs-12">
        <canvas id="myChart" class="chart"
			data-chart-data='{{ data|json_encode|raw }}' 
			data-chart-labels='{{ labels|json_encode|raw }}'
			data-chart-title='Yield'
			data-chart-sub-title='Dividend yield'
			data-chart-sign='%'
		></canvas>
    </div>

	<div>
		<table class="table">
			<thead class="thead-dark">
			<tr>
				<th><a href="{{ path('report_dividend_yield', {'orderBy': 'ticker'}) }}">Ticker</a></th>
				<th>avgPrice</th>
				<th>Last dividend</th>
				<th>Last payout date</th>
				<th>#Payouts per year</th>
				<th><a href="{{ path('report_dividend_yield', {'orderBy': 'dividend'}) }}">Dividend</a></th>
				<th><a href="{{ path('report_dividend_yield', {'orderBy': 'yield'}) }}">Yield</a></th>
				<th>Net forward yearly dividend per share</th>
				<th>Amount</th>
				<th>Net forward dividend per payout</th>
				<th>Net forward yearly dividend total</th>
			</tr>
			</thead>
			<tbody>
				{% for item in datasource %}
				<tr>
					<td><span title="{{ item.label }}">{{ item.ticker }}</span></td>
					<td>&euro;{{ (item.avgPrice)|format_number({fraction_digit: 2}) }}</td>
					<td>{% if item.lastDividend > 0 %}${{ (item.lastDividend)|format_number({fraction_digit: 2}) }}{% else %}-{% endif %}</td>
					<td>{% if item.lastDividendDate is not null %}{{ item.lastDividendDate|date("d-m-Y") }}{% else %} - {% endif %}</td>
					<td>{{ item.numPayoutsPerYear ?: '-' }}</td>
					<td>{% if item.payout > 0 %}${{ (item.payout)|format_number({fraction_digit: 2}) }}{% else %}-{% endif %}</td>
					<td>{% if item.yield > 0 %}{{ item.yield }}%{% else %}-{% endif %}</td>
					<td>{% if item.netForwardYearlyPayout > 0 %}&euro;{{ (item.netForwardYearlyPayout)|format_number({fraction_digit: 2}) }}{% else %}-{% endif %}</td>
					<td>{{ item.amount }}</td>
					<td>{% if (item.netTotalForwardYearlyPayout > 0) and (item.numPayoutsPerYear > 0) %}&euro;{{ (item.netTotalForwardYearlyPayout / item.numPayoutsPerYear)|format_number({fraction_digit: 2}) }}{% endif %}</td>
					<td>{% if item.netTotalForwardYearlyPayout > 0 %}&euro;{{ item.netTotalForwardYearlyPayout|format_number({fraction_digit: 2}) }}{% else %}-{% endif %}</td>
				</tr>
				{% endfor %}
				<tr class="table-primary">
					<td colspan='10'></td>
					<td>&euro;{{ totalNetYearlyDividend|format_number({fraction_digit: 2}) }}</td>
				</td>
			</tbody>
		</table>
	</div>
{% endblock %}

{% block javascripts %}
	{{ parent() }}
	{{ encore_entry_script_tags('barchart') }}
{% endblock %}
